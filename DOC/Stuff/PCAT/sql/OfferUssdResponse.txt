select
	t1.OFFER_USSD_RESPONSE_ID as offerUssdResponseId,
	t3.DISPLAY_VALUE as ussdResponseRef,
	t1.USSD_RESPONSE_ID as ussdResponseId,
	t10.DISPLAY_VALUE as offerKey,
	t1.OFFER_ID as offerId,
	t1.RESELLER_VERSION_ID as resellerVersionId,
	t1.RESPONSE_MSG as responseMsg,
	t1.UNICODE_FLAG as unicodeFlag,
        t5.DISPLAY_VALUE as notifIvrLanguageRef,
        t8.DISPLAY_VALUE as responseCodeDisplayValue
from
	OFFER_USSD_RESPONSE t1
	inner join USSD_RESPONSE_REF t2 on t1.USSD_RESPONSE_ID = t2.USSD_RESPONSE_ID
	inner join USSD_RESPONSE_VALUES t3 on t2.USSD_RESPONSE_ID = t3.USSD_RESPONSE_ID
		and t3.LANGUAGE_CODE = {2}
	inner join NOTIF_IVR_LANGUAGE_REF t4 on t4.NOTIF_IVR_LANGUAGE_ID = t2.NOTIF_IVR_LANGUAGE_CODE
	inner join NOTIF_IVR_LANGUAGE_VALUES t5 on t5.NOTIF_IVR_LANGUAGE_ID = t4.NOTIF_IVR_LANGUAGE_ID
               and t5.LANGUAGE_CODE = t3.LANGUAGE_CODE
	left outer join GUI_INDICATOR_REF t7 on t7.table_name = ''USSD_RESPONSE_REF''
		and t7.field_name = lower(''RESPONSE_CODE'')
		and t7.integer_value = t2.RESPONSE_CODE
	left outer join GUI_INDICATOR_VALUES t8 on t8.table_name = t7.table_name
		and t8.field_name = t7.field_name
		and t8.integer_value = t7.integer_value
                and t8.LANGUAGE_CODE = t3.LANGUAGE_CODE
	inner join OFFER_KEY t8 on t1.OFFER_ID = t8.OFFER_ID
	inner join OFFER_REF t9 on t1.OFFER_ID = t9.OFFER_ID
		and t9.RESELLER_VERSION_ID = t1.RESELLER_VERSION_ID
	inner join OFFER_VALUES t10 on t1.OFFER_ID = t10.OFFER_ID
		and t10.LANGUAGE_CODE = t3.LANGUAGE_CODE
		and t10.RESELLER_VERSION_ID = t1.RESELLER_VERSION_ID
where
	t1.RESELLER_VERSION_ID = {0}