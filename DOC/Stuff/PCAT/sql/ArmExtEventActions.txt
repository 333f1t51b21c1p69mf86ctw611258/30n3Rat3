select
	t1.EXT_EVENT_ID as extEventId,
	t1.EXT_EVENT_TYPE as extEventType,
	t1.COLL_FLAG as collFlag,
	t1.ACTION as action,
	t1.CURRENCY_CODE as currencyCode,
        t5.DISPLAY_VALUE as rateCurrencyKey, 
	t1.UPPER_AMOUNT as upperAmount,
	t1.LOWER_AMOUNT as lowerAmount,
	t1.UPPER_CREDIT_SCORE as upperCreditScore,
	t1.LOWER_CREDIT_SCORE as lowerCreditScore,
	t1.VIP_CODE as vipCode,
        t7.DISPLAY_VALUE as vipCodeRef        
from
	ARM_EXT_EVENT_ACTIONS t1
        inner join ARM_ACTION_DEFINITION t2 on t1.ACTION = t2.ACTION	
        left outer join RATE_CURRENCY_KEY t3 on t1.CURRENCY_CODE = t3.CURRENCY_CODE
	left outer join RATE_CURRENCY_REF t4 on t3.CURRENCY_CODE = t4.CURRENCY_CODE
	     and t4.SERVICE_VERSION_ID = 1
	left outer join RATE_CURRENCY_VALUES t5 on t3.CURRENCY_CODE = t5.CURRENCY_CODE
             and t5.SERVICE_VERSION_ID = {1}
             and t5.LANGUAGE_CODE = {2}
        left outer join VIP_CODE_REF t6 on t1.VIP_CODE = t6.VIP_CODE 
        left outer join VIP_CODE_VALUES t7 on t6.VIP_CODE = t7.VIP_CODE 
            and t7.LANGUAGE_CODE = t5.LANGUAGE_CODE