select
	t1.UPSELL_TEMPLATE_ID as upsellTemplateId,
	t2.RESELLER_VERSION_ID as resellerVersionId,
	t2.TEMPLATE_LEVEL as templateLevel,
	t5.SERVICE_VERSION_ID as serviceVersionId,
	t6.DISPLAY_VALUE as accountCategoryKey,
	t2.ACCOUNT_CATEGORY as accountCategory,
	t8.DISPLAY_VALUE as regulatoryIdRef,
	t2.REGULATORY_ID as regulatoryId,
	t10.DISPLAY_VALUE as vipCodeRef,
	t2.VIP_CODE as vipCode,
	t12.DISPLAY_VALUE as mktCodeRef,
	t2.MKT_CODE as mktCode,
	t3.LANGUAGE_CODE as languageCode,
	t3.DISPLAY_VALUE as displayValue,
	t3.DESCRIPTION as description
from
	UPSELL_TEMPLATE_KEY t1
	inner join UPSELL_TEMPLATE_REF t2 on t1.UPSELL_TEMPLATE_ID = t2.UPSELL_TEMPLATE_ID
	inner join UPSELL_TEMPLATE_VALUES t3 on t2.UPSELL_TEMPLATE_ID = t3.UPSELL_TEMPLATE_ID
		and t2.RESELLER_VERSION_ID = t3.RESELLER_VERSION_ID
	left outer join ACCOUNT_CATEGORY_KEY t4 on t2.ACCOUNT_CATEGORY = t4.ACCOUNT_CATEGORY
	left outer join ACCOUNT_CATEGORY_REF t5 on t4.ACCOUNT_CATEGORY = t5.ACCOUNT_CATEGORY
		and t5.SERVICE_VERSION_ID = {1}
	left outer join ACCOUNT_CATEGORY_VALUES t6 on t4.ACCOUNT_CATEGORY = t6.ACCOUNT_CATEGORY
		and t6.SERVICE_VERSION_ID = {1}
		and t6.LANGUAGE_CODE = t3.LANGUAGE_CODE
	left outer join REGULATORY_ID_REF t7 on t2.REGULATORY_ID = t7.REGULATORY_ID
	left outer join REGULATORY_ID_VALUES t8 on t7.REGULATORY_ID = t8.REGULATORY_ID
		and t8.LANGUAGE_CODE = t3.LANGUAGE_CODE
	left outer join VIP_CODE_REF t9 on t2.VIP_CODE = t9.VIP_CODE
	left outer join VIP_CODE_VALUES t10 on t9.VIP_CODE = t10.VIP_CODE
		and t10.LANGUAGE_CODE = t3.LANGUAGE_CODE
	left outer join MKT_CODE_REF t11 on t2.MKT_CODE = t11.MKT_CODE
	left outer join MKT_CODE_VALUES t12 on t11.MKT_CODE = t12.MKT_CODE
		and t12.LANGUAGE_CODE = t3.LANGUAGE_CODE
where
	t2.RESELLER_VERSION_ID = {0}
	and t3.LANGUAGE_CODE = {2}
