select
	t1.RATE_DISCOUNT_ID as rateDiscountId,
	t1.RESELLER_VERSION_ID as resellerVersionId,
	t4.DISPLAY_VALUE as btDiscountItemKey,
	t1.DISCOUNT_ID as discountId,
	t9.SERVICE_VERSION_ID as serviceVersionId,
	t10.DISPLAY_VALUE as rateClassKey,
	t1.RATE_CLASS as rateClass,
	t1.RANGE_ORIGIN as rangeOrigin,
	t1.RANGE_TERMINUS as rangeTerminus,
	t12.DISPLAY_VALUE as billingFrequencyRef,
	t1.BILLING_FREQUENCY as billingFrequency,
	t1.CURRENCY_CODE as currencyCode,
        t15.display_value as rateCurrencyKey, 
        t6.iso_code as currencyIsoCode, 
        t6.implied_decimal as currencyImpliedDecimal, 
	t1.DISCOUNT_PERCENT as discountPercent,
	t1.IMPLIED_DECIMALS as impliedDecimals,
	t1.DISCOUNT_AMOUNT as discountAmount,
	t1.DATE_CREATED as dateCreated,
	t1.LOOKUP_THRESHOLD_TIER_ID as lookupThresholdTierId,
	t1.QUALIFYING_THRESHOLD_TIER_ID as qualifyingThresholdTierId
from
	RATE_DISCOUNT t1
	inner join BT_DISCOUNT_ITEM_KEY t2 on t1.DISCOUNT_ID = t2.DISCOUNT_ID
        inner join (select reseller_id, major_version_num, reseller_version_id from reseller_version where reseller_version_id = {0}) tReseller on t1.reseller_version_id = tReseller.Reseller_Version_Id
        inner join (select reseller_version_id, service_version_id, major_version_num, minor_version_num, reseller_id from reseller_version) tBaseVersion on tReseller.Reseller_Id = tBaseVersion.Reseller_Id  
                and tReseller.Major_Version_Num = tBaseVersion.Major_Version_Num 
                and tBaseVersion.Minor_Version_Num = 0   
	inner join BT_DISCOUNT_ITEM_REF t3 on t1.DISCOUNT_ID = t3.DISCOUNT_ID
		and t3.RESELLER_VERSION_ID = tBaseVersion.RESELLER_VERSION_ID
	inner join BT_DISCOUNT_ITEM_VALUES t4 on t1.DISCOUNT_ID = t4.DISCOUNT_ID
		and t4.RESELLER_VERSION_ID = tBaseVersion.RESELLER_VERSION_ID    
        inner join RATE_CURRENCY_KEY t5 on t1.currency_code = t5.currency_code            
        inner join RATE_CURRENCY_REF t6 on t5.currency_code = t6.currency_code 
                and t6.service_version_id = tBaseVersion.Service_Version_Id       
        inner join RATE_CURRENCY_VALUES t7 on t6.currency_code = t7.currency_code 
                and t6.service_version_id = t7.service_version_id 
                and t7.language_code = t4.language_code         
	left outer join RATE_CLASS_KEY t8 on t1.RATE_CLASS = t8.RATE_CLASS
	left outer join RATE_CLASS_REF t9 on t8.RATE_CLASS = t9.RATE_CLASS
		and t9.SERVICE_VERSION_ID = t6.service_version_id
	left outer join RATE_CLASS_VALUES t10 on t9.RATE_CLASS = t10.RATE_CLASS
		and t10.LANGUAGE_CODE = t4.LANGUAGE_CODE
		and t10.SERVICE_VERSION_ID = t9.SERVICE_VERSION_ID
	inner join BILLING_FREQUENCY_REF t11 on t1.BILLING_FREQUENCY = t11.BILLING_FREQUENCY
	inner join BILLING_FREQUENCY_VALUES t12 on t11.BILLING_FREQUENCY = t12.BILLING_FREQUENCY
		and t12.LANGUAGE_CODE = t4.LANGUAGE_CODE   
        inner join rate_currency_key t13 on t1.currency_code = t13.currency_code 
        inner join rate_currency_ref t14 on t13.currency_code = t14.currency_code 
                and t14.service_version_id = tBaseVersion.SERVICE_VERSION_ID 
        inner join rate_currency_values t15 on t15.currency_code = t14.currency_code 
                and t15.service_version_id = t14.service_version_id 
                and t15.language_code = t4.language_code  
where
	t4.LANGUAGE_CODE = {2} 
