select
	t1.EVT_UNQ_ID as evtUnqId,
	t4.DISPLAY_VALUE as eventKey,
	t1.EVENT_ID as eventId,
	t1.RESELLER_VERSION_ID as resellerVersionId,
	t1.CRITERIA_FIELD as criteriaFieldId,
        t5.DISPLAY_VALUE as criteriaField,
	t1.CRITERIA_OP as criteriaOpId,
        t11.DISPLAY_VALUE as criteriaOp,
	t1.CRITERIA_VAL_MONEY as criteriaValMoney,
	t1.CRITERIA_VAL_STATE as criteriaValState,
        t12.DISPLAY_VALUE as subscriberStateIdRef,
	t1.DISPLAY_FIRST as displayFirst,
	t1.SERIAL_ID as serialId,
	t1.CRITERIA_VAL_NUM as criteriaValNum,
        CASE t1.CRITERIA_VAL_ACTIVITIES
            WHEN ''0000000000000000'' THEN null
            ELSE t1.CRITERIA_VAL_ACTIVITIES
        END as criteriaValActivities,
	t1.CRITERIA_SUB_FIELD as criteriaSubFieldId,
        CASE
            WHEN t1.CRITERIA_FIELD in (2,3,20,21,22,102) THEN t6.DISPLAY_VALUE
            WHEN t1.CRITERIA_FIELD in (23,24,25) then t7.DISPLAY_VALUE
            WHEN t1.CRITERIA_FIELD in (26,27) THEN t8.DISPLAY_VALUE
            WHEN t1.CRITERIA_FIELD in (15,16,17) THEN t9.DISPLAY_VALUE
            WHEN t1.CRITERIA_FIELD in (18,19) THEN t10.DISPLAY_VALUE
            ELSE null
        END as criteriaSubFieldString,
        t1.TRIGGER_LEVEL as triggerLevelId,
	t14.DISPLAY_VALUE as triggerLevel
from
	EVENT_TRIGGERS t1
	inner join EVENT_KEY t2 on t1.EVENT_ID = t2.EVENT_ID
	inner join EVENT_REF t3 on t2.EVENT_ID = t3.EVENT_ID
		and t3.RESELLER_VERSION_ID = t1.RESELLER_VERSION_ID
	inner join EVENT_VALUES t4 on t2.EVENT_ID = t4.EVENT_ID
		and t4.RESELLER_VERSION_ID = t1.RESELLER_VERSION_ID
		and t4.LANGUAGE_CODE = {2}
        inner join PARAMETER_SUB_ID_VALUES t5 on t4.LANGUAGE_CODE = t5.LANGUAGE_CODE
                and t1.CRITERIA_FIELD = t5.PARAM_SUB_ID
                and t5.PARAM_ID in (1,12,13)
        left outer join BALANCE_VALUES t6 on t1.CRITERIA_SUB_FIELD = t6.BALANCE_ID
                and t1.CRITERIA_FIELD in (2,3,20,21,22,102)
                and t6.RESELLER_VERSION_ID = t1.RESELLER_VERSION_ID
                and t6.LANGUAGE_CODE = t4.LANGUAGE_CODE
        left outer join OFFER_VALUES t7 on t1.CRITERIA_SUB_FIELD = t7.OFFER_ID
                and t1.CRITERIA_FIELD in (23,24,25)
                and t7.RESELLER_VERSION_ID = t1.RESELLER_VERSION_ID
                and t7.LANGUAGE_CODE = t4.LANGUAGE_CODE
        left outer join BUNDLE_VALUES t8 on t1.CRITERIA_SUB_FIELD = t8.BUNDLE_ID
                and t1.CRITERIA_FIELD in (26,27)
                and t8.RESELLER_VERSION_ID = t1.RESELLER_VERSION_ID
                and t8.LANGUAGE_CODE = t4.LANGUAGE_CODE
        left outer join RC_TERM_VALUES t9 on t1.CRITERIA_SUB_FIELD = t9.RC_TERM_ID
                and t1.CRITERIA_FIELD in (15,16,17)
                and t9.RESELLER_VERSION_ID = t1.RESELLER_VERSION_ID
                and t9.LANGUAGE_CODE = t4.LANGUAGE_CODE
        left outer join NRC_TERM_VALUES t10 on t1.CRITERIA_SUB_FIELD = t10.NRC_TERM_ID
                and t1.CRITERIA_FIELD in (18,19)
                and t10.RESELLER_VERSION_ID = t1.RESELLER_VERSION_ID
                and t10.LANGUAGE_CODE = t4.LANGUAGE_CODE
        left outer join PARAMETER_SUB_ID_VALUES t11 on t4.LANGUAGE_CODE = t11.LANGUAGE_CODE
                and t1.CRITERIA_OP = t11.PARAM_SUB_ID
                and t11.PARAM_ID = 2
                and t11.PARAM_SUB_ID between 1 and 8
        left outer join SUBSCRIBER_STATE_ID_VALUES t12 on t4.LANGUAGE_CODE = t12.LANGUAGE_CODE
                and t1.CRITERIA_VAL_STATE = t12.STATE_ID
                and t1.LEVEL_CODE = t12.LEVEL_CODE
	left outer join GUI_INDICATOR_REF t13 on t13.table_name = ''EVENT_TRIGGERS''
		and t13.field_name = lower(''TRIGGER_LEVEL'')
		and t13.integer_value = t1.TRIGGER_LEVEL
	left outer join GUI_INDICATOR_VALUES t14 on t14.table_name = t13.table_name
		and t14.field_name = t13.field_name
		and t14.integer_value = t13.integer_value
		and t14.LANGUAGE_CODE = t4.LANGUAGE_CODE
where
	t1.RESELLER_VERSION_ID = {0}
