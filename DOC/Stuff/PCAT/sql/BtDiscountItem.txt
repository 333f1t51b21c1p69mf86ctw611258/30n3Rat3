select
	t1.DISCOUNT_ID as discountId,
	t2.RESELLER_VERSION_ID as resellerVersionId,
	t2.FOREIGN_CODE as foreignCode,
	t5.DISPLAY_VALUE as discountLevel,
	t7.DISPLAY_VALUE as discountDomain,
	t9.DISPLAY_VALUE as discountQuantum,
	t11.DISPLAY_VALUE as discountType,
	t14.DISPLAY_VALUE as usagePlanKey,
	t2.USAGE_PLAN_ID as usagePlanId,
	t17.DISPLAY_VALUE as productLineKey,
	t2.PRODUCT_LINE_ID as productLineId,
	t2.FORMAT_CODE as formatCode,
	t2.DOMAIN_ID as domainId,
	t2.PROVIDER_ID as providerId,
	t2.DATE_ACTIVE as dateActive,
	t2.DATE_INACTIVE as dateInactive,
	t2.DATE_CREATED as dateCreated,
	t2.SAVE_DETAIL as saveDetail,
	t20.DISPLAY_VALUE as timeTypeKey,
	t2.TIME_TYPE_ID as timeTypeId,
	t22.SERVICE_VERSION_ID as serviceVersionId,
	t23.DISPLAY_VALUE as jurisdictionsKey,
	t2.JURISDICTION as jurisdiction,
	t2.IS_GROSS as isGross,
	t2.IS_EXCLUSIVE as isExclusive,
	t2.CORRIDOR_PLAN_ID as corridorPlanId,
	t2.ICB_ALLOW as icbAllow,
	t3.LANGUAGE_CODE as languageCode,
	t3.DISPLAY_VALUE as displayValue,
	t3.DESCRIPTION as description
from
	BT_DISCOUNT_ITEM_KEY t1
	inner join BT_DISCOUNT_ITEM_REF t2 on t1.DISCOUNT_ID = t2.DISCOUNT_ID
	inner join BT_DISCOUNT_ITEM_VALUES t3 on t2.DISCOUNT_ID = t3.DISCOUNT_ID
		and t2.RESELLER_VERSION_ID = t3.RESELLER_VERSION_ID
	left outer join GUI_INDICATOR_REF t4 on t4.table_name = ''BT_DISCOUNT_ITEM_REF''
		and t4.field_name = lower(''DISCOUNT_LEVEL'')
		and t4.integer_value = t2.DISCOUNT_LEVEL
	left outer join GUI_INDICATOR_VALUES t5 on t5.table_name = t4.table_name
		and t5.field_name = t4.field_name
		and t5.integer_value = t4.integer_value
		and t5.LANGUAGE_CODE = t3.LANGUAGE_CODE
	left outer join GUI_INDICATOR_REF t6 on t6.table_name = ''BT_DISCOUNT_ITEM_REF''
		and t6.field_name = lower(''DISCOUNT_DOMAIN'')
		and t6.integer_value = t2.DISCOUNT_DOMAIN
	left outer join GUI_INDICATOR_VALUES t7 on t7.table_name = t6.table_name
		and t7.field_name = t6.field_name
		and t7.integer_value = t6.integer_value
		and t7.LANGUAGE_CODE = t3.LANGUAGE_CODE
	left outer join GUI_INDICATOR_REF t8 on t8.table_name = ''BT_DISCOUNT_ITEM_REF''
		and t8.field_name = lower(''DISCOUNT_QUANTUM'')
		and t8.integer_value = t2.DISCOUNT_QUANTUM
	left outer join GUI_INDICATOR_VALUES t9 on t9.table_name = t8.table_name
		and t9.field_name = t8.field_name
		and t9.integer_value = t8.integer_value
		and t9.LANGUAGE_CODE = t3.LANGUAGE_CODE
	left outer join GUI_INDICATOR_REF t10 on t10.table_name = ''BT_DISCOUNT_ITEM_REF''
		and t10.field_name = lower(''DISCOUNT_TYPE'')
		and t10.integer_value = t2.DISCOUNT_TYPE
	left outer join GUI_INDICATOR_VALUES t11 on t11.table_name = t10.table_name
		and t11.field_name = t10.field_name
		and t11.integer_value = t10.integer_value
		and t11.LANGUAGE_CODE = t3.LANGUAGE_CODE
	left outer join USAGE_PLAN_KEY t12 on t2.USAGE_PLAN_ID = t12.USAGE_PLAN_ID
	left outer join USAGE_PLAN_REF t13 on t12.USAGE_PLAN_ID = t13.USAGE_PLAN_ID
		and t13.RESELLER_VERSION_ID = t2.RESELLER_VERSION_ID
	left outer join USAGE_PLAN_VALUES t14 on t12.USAGE_PLAN_ID = t14.USAGE_PLAN_ID
		and t14.RESELLER_VERSION_ID = t2.RESELLER_VERSION_ID
		and t14.LANGUAGE_CODE = t3.LANGUAGE_CODE
	left outer join PRODUCT_LINE_KEY t15 on t2.PRODUCT_LINE_ID = t15.PRODUCT_LINE_ID
	left outer join PRODUCT_LINE_REF t16 on t15.PRODUCT_LINE_ID = t16.PRODUCT_LINE_ID
		and t16.RESELLER_VERSION_ID = t2.RESELLER_VERSION_ID
	left outer join PRODUCT_LINE_VALUES t17 on t15.PRODUCT_LINE_ID = t17.PRODUCT_LINE_ID
		and t17.RESELLER_VERSION_ID = t2.RESELLER_VERSION_ID
		and t17.LANGUAGE_CODE = t3.LANGUAGE_CODE
	left outer join TIME_TYPE_KEY t18 on t2.TIME_TYPE_ID = t18.TIME_TYPE_ID
	left outer join TIME_TYPE_REF t19 on t18.TIME_TYPE_ID = t19.TIME_TYPE_ID
		and t19.RESELLER_VERSION_ID = t2.RESELLER_VERSION_ID
	left outer join TIME_TYPE_VALUES t20 on t18.TIME_TYPE_ID = t20.TIME_TYPE_ID
		and t20.RESELLER_VERSION_ID = t2.RESELLER_VERSION_ID
		and t20.LANGUAGE_CODE = t3.LANGUAGE_CODE
	left outer join JURISDICTIONS_KEY t21 on t2.JURISDICTION = t21.JURISDICTION
	left outer join JURISDICTIONS_REF t22 on t21.JURISDICTION = t22.JURISDICTION
		and t22.SERVICE_VERSION_ID = {1}
	left outer join JURISDICTIONS_VALUES t23 on t21.JURISDICTION = t23.JURISDICTION
		and t23.SERVICE_VERSION_ID = {1}
		and t23.LANGUAGE_CODE = t3.LANGUAGE_CODE
where
	t2.RESELLER_VERSION_ID = {0}
	and t3.LANGUAGE_CODE = {2}
