select
	t1.OUTPUT_GROUP_ID as outputGroupId,
	t1.LETTER_TYPE as letterType,
	t5.DISPLAY_VALUE as countryCodeRef,
	t1.COUNTRY_CODE as countryCode,
	t1.LOWER_BALANCE_DUE as lowerBalanceDue,
	t1.UPPER_BALANCE_DUE as upperBalanceDue,
	t1.HOURS_TO_OPEN as hoursToOpen,
	t1.NUMBER_OF_LETTERS_PER_FILE as numberOfLettersPerFile,
	t7.SERVICE_VERSION_ID as serviceVersionId,
	t7.ISO_CODE as currencyIsoCode,
	t7.IMPLIED_DECIMAL as currencyImpliedDecimal,
	t8.DISPLAY_VALUE as rateCurrencyKey,
	t1.CURRENCY_CODE as currencyCode,
	t1.EXT_EVENT_ID as extEventId,
	t1.EXT_EVENT_TYPE as extEventType,
	t1.IS_INTERNAL as isInternal,
	t2.LANGUAGE_CODE as languageCode,
	t2.DISPLAY_VALUE as displayValue
from
	ARM_OUTPUT_GROUP_REF t1
	inner join ARM_OUTPUT_GROUP_VALUES t2 on t1.OUTPUT_GROUP_ID = t2.OUTPUT_GROUP_ID
	inner join ARM_ACTION_DEFINITION t3 on t1.LETTER_TYPE = t3.ACTION
	left outer join COUNTRY_CODE_REF t4 on t1.COUNTRY_CODE = t4.COUNTRY_CODE
	left outer join COUNTRY_CODE_VALUES t5 on t4.COUNTRY_CODE = t5.COUNTRY_CODE
		and t5.LANGUAGE_CODE = t2.LANGUAGE_CODE
	inner join RATE_CURRENCY_KEY t6 on t1.CURRENCY_CODE = t6.CURRENCY_CODE
	inner join RATE_CURRENCY_REF t7 on t6.CURRENCY_CODE = t7.CURRENCY_CODE
		and t7.SERVICE_VERSION_ID = {1}
	inner join RATE_CURRENCY_VALUES t8 on t6.CURRENCY_CODE = t8.CURRENCY_CODE
		and t8.SERVICE_VERSION_ID = t7.SERVICE_VERSION_ID
		and t8.LANGUAGE_CODE = t2.LANGUAGE_CODE
where
	t2.LANGUAGE_CODE = {2}
