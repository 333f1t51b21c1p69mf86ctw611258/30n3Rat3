//package e1reformat.db.dao;
//
//import java.sql.Connection;
//import java.sql.PreparedStatement;
//import java.sql.ResultSet;
//import java.util.ArrayList;
//
//import org.apache.commons.lang3.StringUtils;
//
//import e1reformat.db.pool.DBConfig;
//import e1reformat.entity.enrich.MapFileReport;
//import java.sql.SQLException;
//
//public class FileReportDao {
//
//    private static DBConfig dbconfig = new DBConfig();
//    static int SUCCESS = 0;
//    static int ERROR = -1;
//
//    public static ArrayList<MapFileReport> getListFileReport(Connection conn) {
//
//        ArrayList<MapFileReport> searchResult = new ArrayList<MapFileReport>();
//        PreparedStatement pstmt = null;
//        ResultSet rs = null;
//        try {
//            String sql = "SELECT a.status, b.cdr_record_header_id, b.convert_time, b.cdr_filename, b.start_rcd_seq, b.end_rcd_seq, b.number_of_record from"
//                    + dbconfig.getDb_schema() + "cdr_log_process a, cdr_record_header b" + "where a.CDR_LOG_PROCESS_ID = b.CDR_RECORD_HEADER_ID";
//
//            pstmt = conn.prepareStatement(sql);
//            rs = pstmt.executeQuery();
//            while (rs.next()) {
//
//                String cdr_record_header_id = rs.getString(1);
//                String convert_time = rs.getString(2);
//                String cdr_filename = rs.getString(3);
//                String start_rcd_seq = rs.getString(4);
//                String end_rcd_seq = rs.getString(5);
//                String number_of_record = rs.getString(6);
//                String status = rs.getString(7);
//
//                MapFileReport mapFileReport = new MapFileReport(cdr_record_header_id, convert_time, cdr_filename, start_rcd_seq, end_rcd_seq, number_of_record, status);
//                searchResult.add(mapFileReport);
//            }
//        } catch (Exception e) {
//            e.printStackTrace();
//        } finally {
//            try {
//                conn.close();
//                rs.close();
//                pstmt.close();
//            } catch (SQLException ex) {
//                ex.fillInStackTrace();
//            }
//        }
//        return searchResult;
//    }
//
//    public static ArrayList<MapFileReport> getSearchFileReport(String fromDate, String toDate, Connection conn) {
//
//        ArrayList<MapFileReport> searchResult = new ArrayList<MapFileReport>();
//        PreparedStatement pstmt = null;
//        ResultSet rs = null;
//        StringBuilder query = new StringBuilder("");
//
//        try {
//
//            query.append("SELECT a.status, b.cdr_record_header_id, b.convert_time, b.cdr_filename, b.start_rcd_seq, b.end_rcd_seq, b.number_of_record");
//            query.append(" FROM " + dbconfig.getDb_schema() + "cdr_log_process a, cdr_record_header b");
//            query.append(" WHERE a.CDR_LOG_PROCESS_ID = b.CDR_RECORD_HEADER_ID");
//            if (StringUtils.isNotEmpty(fromDate)) {
//                query.append(" AND convert_time >= to_date( ? ,'MM/DD/YYYY')");
//            }
//            if (StringUtils.isNotEmpty(toDate)) {
//                query.append(" AND convert_time <= to_date( ? ,'MM/DD/YYYY')");
//            }
//            pstmt = conn.prepareStatement(query.toString());
//            if (StringUtils.isNotEmpty(fromDate)) {
//                pstmt.setString(1, fromDate);
//            }
//            if (StringUtils.isNotEmpty(toDate)) {
//                if (fromDate != null) {
//                    pstmt.setString(2, toDate);
//                } else {
//                    pstmt.setString(1, toDate);
//                }
//            }
//
//            rs = pstmt.executeQuery();
//            while (rs.next()) {
//                String cdr_record_header_id = rs.getString("cdr_record_header_id");
//                String convert_time = rs.getString("convert_time");
//                String cdr_filename = rs.getString("cdr_filename");
//                String start_rcd_seq = rs.getString("start_rcd_seq");
//                String end_rcd_seq = rs.getString("end_rcd_seq");
//                String number_of_record = rs.getString("number_of_record");
//                String status = rs.getString("status");
//                MapFileReport mapFileReport = new MapFileReport(cdr_record_header_id, convert_time,
//                        cdr_filename, start_rcd_seq, end_rcd_seq,
//                        number_of_record, status);
//
//                searchResult.add(mapFileReport);
//            }
//        } catch (Exception e) {
//            e.printStackTrace();
//        } finally {
//            try {
//                conn.close();
//                rs.close();
//                pstmt.close();
//            } catch (SQLException ex) {
//                ex.fillInStackTrace();
//            }
//        }
//        return searchResult;
//    }
//
//    public static Boolean checkExistHeaderId(String cdr_record_header_id, Connection conn) {
//
//        PreparedStatement pstmt = null;
//        ResultSet rs = null;
//        int result = 0;
//        try {
//            String query = "SELECT count(1) FROM " + dbconfig.getDb_schema() + "CDR_RECORD_HEADER where CDR_RECORD_HEADER = '" + cdr_record_header_id + "'";
//            pstmt = conn.prepareStatement(query);
//            rs = pstmt.executeQuery(query);
//            rs.next();
//            result = rs.getInt(1);
//        } catch (Exception e) {
//            System.out.println("Exception: " + e.getMessage());
//        }finally {
//            try {
//                rs.close();
//                pstmt.close();
//            } catch (SQLException ex) {
//                ex.fillInStackTrace();
//            }
//        }
//
//        if (result > 0) {
//            return true;
//        } else {
//            return false;
//        }
//    }
//
//}
