select
	t1.RATE_DISCOUNT_ID as rateDiscountId,
	t1.RESELLER_VERSION_ID as resellerVersionId,
	t4.DISPLAY_VALUE as btDiscountItemKey,
	t1.DISCOUNT_ID as discountId,
	t6.SERVICE_VERSION_ID as serviceVersionId,
	t7.DISPLAY_VALUE as rateClassKey,
	t1.RATE_CLASS as rateClass,
	t1.RANGE_ORIGIN as rangeOrigin,
	t1.RANGE_TERMINUS as rangeTerminus,
	t9.DISPLAY_VALUE as billingFrequencyRef,
	t1.BILLING_FREQUENCY as billingFrequency,
	t1.CURRENCY_CODE as currencyCode, 
        t12.DISPLAY_VALUE as rateCurrencyKey,  
        t11.ISO_CODE as currencyIsoCode, 
        t11.IMPLIED_DECIMAL as currencyImpliedDecimal, 
	t1.DISCOUNT_PERCENT as discountPercent,
	t1.IMPLIED_DECIMALS as impliedDecimals,
	t1.DISCOUNT_AMOUNT as discountAmount,
	t1.DATE_CREATED as dateCreated,
	t1.LOOKUP_THRESHOLD_TIER_ID as lookupThresholdTierId,
	t1.QUALIFYING_THRESHOLD_TIER_ID as qualifyingThresholdTierId
from
	RATE_DISCOUNT t1
	inner join BT_DISCOUNT_ITEM_KEY t2 on t1.DISCOUNT_ID = t2.DISCOUNT_ID
	inner join BT_DISCOUNT_ITEM_REF t3 on t2.DISCOUNT_ID = t3.DISCOUNT_ID
		and t3.RESELLER_VERSION_ID = t1.RESELLER_VERSION_ID
	inner join BT_DISCOUNT_ITEM_VALUES t4 on t2.DISCOUNT_ID = t4.DISCOUNT_ID
		and t4.RESELLER_VERSION_ID = t1.RESELLER_VERSION_ID
		and t4.LANGUAGE_CODE = {2} 
	left outer join RATE_CLASS_KEY t5 on t1.RATE_CLASS = t5.RATE_CLASS
	left outer join RATE_CLASS_REF t6 on t5.RATE_CLASS = t6.RATE_CLASS
		and t6.SERVICE_VERSION_ID = {1}
	left outer join RATE_CLASS_VALUES t7 on t5.RATE_CLASS = t7.RATE_CLASS
		and t7.SERVICE_VERSION_ID = {1}
		and t7.LANGUAGE_CODE = t4.LANGUAGE_CODE
	inner join BILLING_FREQUENCY_REF t8 on t1.BILLING_FREQUENCY = t8.BILLING_FREQUENCY
	inner join BILLING_FREQUENCY_VALUES t9 on t8.BILLING_FREQUENCY = t9.BILLING_FREQUENCY
		and t9.LANGUAGE_CODE = t4.LANGUAGE_CODE    
        inner join RATE_CURRENCY_KEY t10 on t1.CURRENCY_CODE = t10.CURRENCY_CODE            
        inner join RATE_CURRENCY_REF t11 on t10.CURRENCY_CODE = t11.CURRENCY_CODE 
                and t11.SERVICE_VERSION_ID = {1}          
        inner join RATE_CURRENCY_VALUES t12 on t10.CURRENCY_CODE = t12.CURRENCY_CODE 
                and t12.SERVICE_VERSION_ID = t11.SERVICE_VERSION_ID 
                and t12.language_code = t4.language_code 
where
	t1.RESELLER_VERSION_ID = {0} 
