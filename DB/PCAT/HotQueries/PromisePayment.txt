select
	t1.PP_ID as ppId,
	t2.RESELLER_VERSION_ID as resellerVersionId,
	t5.SERVICE_VERSION_ID as serviceVersionId,
	t5.ISO_CODE as currencyIsoCode,
	t5.IMPLIED_DECIMAL as currencyImpliedDecimal,
	t6.DISPLAY_VALUE as rateCurrencyKey,
	t2.CURRENCY_CODE as currencyCode,
	t2.MAX_AMOUNT as maxAmount,
	t2.SUB_MIN_CORE_BAL as subMinCoreBal,
	t2.SUB_MAX_CORE_BAL as subMaxCoreBal,
	t2.LAST_RECHARGE_QTY as lastRechargeQty,
	t8.DISPLAY_VALUE as lastRechargeUnit,
	t2.SERVICE_FEE_PERCENTAGE as serviceFeePercentage,
	t2.SERVICE_FEE_FIXED as serviceFeeFixed,
	t10.DISPLAY_VALUE as repaymentType,
	t2.MAX_BAL_OFFSET as maxBalOffset,
	t2.DEFAULT_BAL_OFFSET as defaultBalOffset,
	t2.MAX_ALLOWED_QTY as maxAllowedQty,
	t12.DISPLAY_VALUE as maxAllowedUnit,
	t2.DEFAULT_DUE_DAYS as defaultDueDays,
	t2.MAX_DUE_DAYS as maxDueDays,
	t2.MAX_PP_OUTSTANDING as maxPpOutstanding,
	t3.LANGUAGE_CODE as languageCode,
	t3.DISPLAY_VALUE as displayValue,
	t3.DESCRIPTION as description
from
	PROMISE_PAYMENT_KEY t1
	inner join PROMISE_PAYMENT_REF t2 on t1.PP_ID = t2.PP_ID
	inner join PROMISE_PAYMENT_VALUES t3 on t2.PP_ID = t3.PP_ID
		and t2.RESELLER_VERSION_ID = t3.RESELLER_VERSION_ID
	inner join RATE_CURRENCY_KEY t4 on t2.CURRENCY_CODE = t4.CURRENCY_CODE
	inner join RATE_CURRENCY_REF t5 on t4.CURRENCY_CODE = t5.CURRENCY_CODE
		and t5.SERVICE_VERSION_ID = {1}
	inner join RATE_CURRENCY_VALUES t6 on t4.CURRENCY_CODE = t6.CURRENCY_CODE
		and t6.SERVICE_VERSION_ID = t5.SERVICE_VERSION_ID
		and t6.LANGUAGE_CODE = t3.LANGUAGE_CODE
	left outer join GUI_INDICATOR_REF t7 on t7.table_name = ''PROMISE_PAYMENT_REF''
		and t7.field_name = lower(''LAST_RECHARGE_UNIT'')
		and t7.integer_value = t2.LAST_RECHARGE_UNIT
	left outer join GUI_INDICATOR_VALUES t8 on t8.table_name = t7.table_name
		and t8.field_name = t7.field_name
		and t8.integer_value = t7.integer_value
		and t8.LANGUAGE_CODE = t3.LANGUAGE_CODE
	left outer join GUI_INDICATOR_REF t9 on t9.table_name = ''PROMISE_PAYMENT_REF''
		and t9.field_name = lower(''REPAYMENT_TYPE'')
		and t9.integer_value = t2.REPAYMENT_TYPE
	left outer join GUI_INDICATOR_VALUES t10 on t10.table_name = t9.table_name
		and t10.field_name = t9.field_name
		and t10.integer_value = t9.integer_value
		and t10.LANGUAGE_CODE = t3.LANGUAGE_CODE
	left outer join GUI_INDICATOR_REF t11 on t11.table_name = ''PROMISE_PAYMENT_REF''
		and t11.field_name = lower(''MAX_ALLOWED_UNIT'')
		and t11.integer_value = t2.MAX_ALLOWED_UNIT
	left outer join GUI_INDICATOR_VALUES t12 on t12.table_name = t11.table_name
		and t12.field_name = t11.field_name
		and t12.integer_value = t11.integer_value
		and t12.LANGUAGE_CODE = t3.LANGUAGE_CODE
where
	t2.RESELLER_VERSION_ID = {0}
	and t3.LANGUAGE_CODE = {2}
