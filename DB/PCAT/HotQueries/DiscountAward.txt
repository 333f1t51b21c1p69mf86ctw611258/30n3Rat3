select
	t1.DISCOUNT_AWARD_ID as discountAwardId,
	t2.RESELLER_VERSION_ID as resellerVersionId,
	t6.DISPLAY_VALUE as rtDiscountKey,
	t2.RT_DISCOUNT_ID as rtDiscountId,
	t2.THRESHOLD as threshold,
	t2.AMOUNT as amount, 
        t5.currency_code, 
        t10.iso_code as currencyIsoCode, 
        t10.implied_decimal as currencyImpliedDecimals, 
	t2.ADDON_THRES1 as addonThres1,
	t2.ADDON_THRES2 as addonThres2,
	t2.ADDON_THRES3 as addonThres3,
	t2.ADDON_THRES4 as addonThres4,
	t8.DISPLAY_VALUE as rewardEventType,
	t2.REWARD_NOTIF_TEXT as rewardNotifText,
	t2.UNICODE_FLAG as unicodeFlag,
	t3.LANGUAGE_CODE as languageCode,
	t3.DISPLAY_VALUE as displayValue,
	t3.DESCRIPTION as description
from
	DISCOUNT_AWARD_KEY t1
	inner join DISCOUNT_AWARD_REF t2 on t1.DISCOUNT_AWARD_ID = t2.DISCOUNT_AWARD_ID
	inner join DISCOUNT_AWARD_VALUES t3 on t2.DISCOUNT_AWARD_ID = t3.DISCOUNT_AWARD_ID
		and t2.RESELLER_VERSION_ID = t3.RESELLER_VERSION_ID
	inner join RT_DISCOUNT_KEY t4 on t2.RT_DISCOUNT_ID = t4.RT_DISCOUNT_ID
	inner join RT_DISCOUNT_REF t5 on t4.RT_DISCOUNT_ID = t5.RT_DISCOUNT_ID
		and t5.RESELLER_VERSION_ID = t2.RESELLER_VERSION_ID 
        left outer join RATE_CURRENCY_KEY t9 on t5.currency_code = t9.Currency_Code 
        left outer join RATE_CURRENCY_REF t10 on t9.currency_code = t10.currency_code 
                and t10.service_version_id = {1}
	inner join RT_DISCOUNT_VALUES t6 on t4.RT_DISCOUNT_ID = t6.RT_DISCOUNT_ID
		and t6.RESELLER_VERSION_ID = t2.RESELLER_VERSION_ID
		and t6.LANGUAGE_CODE = t3.LANGUAGE_CODE
	left outer join GUI_INDICATOR_REF t7 on t7.table_name = ''DISCOUNT_AWARD_REF''
		and t7.field_name = lower(''REWARD_EVENT_TYPE'')
		and t7.integer_value = t2.REWARD_EVENT_TYPE
	left outer join GUI_INDICATOR_VALUES t8 on t8.table_name = t7.table_name
		and t8.field_name = t7.field_name
		and t8.integer_value = t7.integer_value
		and t8.LANGUAGE_CODE = t3.LANGUAGE_CODE
where
	t2.RESELLER_VERSION_ID = {0}
	and t3.LANGUAGE_CODE = {2}
