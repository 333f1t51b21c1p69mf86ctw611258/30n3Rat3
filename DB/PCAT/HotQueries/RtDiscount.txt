select
	t1.RT_DISCOUNT_ID as rtDiscountId,
	t2.RESELLER_VERSION_ID as resellerVersionId,
	t6.DISPLAY_VALUE as accumulatorKeyByAccumulatorId,
	t2.ACCUMULATOR_ID as accumulatorId,
	t8.DISPLAY_VALUE as discountType,
	t10.SERVICE_VERSION_ID as serviceVersionId,
	t10.ISO_CODE as currencyIsoCode,
	t10.IMPLIED_DECIMAL as currencyImpliedDecimal,
	t11.DISPLAY_VALUE as rateCurrencyKey,
	t2.CURRENCY_CODE as currencyCode,
	t14.DISPLAY_VALUE as accumulatorKeyByAddonAccId1,
	t2.ADDON_ACC_ID1 as addonAccId1,
	t17.DISPLAY_VALUE as accumulatorKeyByAddonAccId2,
	t2.ADDON_ACC_ID2 as addonAccId2,
	t20.DISPLAY_VALUE as accumulatorKeyByAddonAccId3,
	t2.ADDON_ACC_ID3 as addonAccId3,
	t23.DISPLAY_VALUE as accumulatorKeyByAddonAccId4,
	t2.ADDON_ACC_ID4 as addonAccId4,
	t2.RESET_FLAG as resetFlag,
	t2.IS_DEFAULT as isDefault,
	t2.IS_INTERNAL as isInternal,
	t3.LANGUAGE_CODE as languageCode,
	t3.DISPLAY_VALUE as displayValue,
	t3.DESCRIPTION as description
from
	RT_DISCOUNT_KEY t1
	inner join RT_DISCOUNT_REF t2 on t1.RT_DISCOUNT_ID = t2.RT_DISCOUNT_ID
	inner join RT_DISCOUNT_VALUES t3 on t2.RT_DISCOUNT_ID = t3.RT_DISCOUNT_ID
		and t2.RESELLER_VERSION_ID = t3.RESELLER_VERSION_ID
	inner join ACCUMULATOR_KEY t4 on t2.ACCUMULATOR_ID = t4.ACCUMULATOR_ID
	inner join ACCUMULATOR_REF t5 on t4.ACCUMULATOR_ID = t5.ACCUMULATOR_ID
		and t5.RESELLER_VERSION_ID = t2.RESELLER_VERSION_ID
	inner join ACCUMULATOR_VALUES t6 on t4.ACCUMULATOR_ID = t6.ACCUMULATOR_ID
		and t6.RESELLER_VERSION_ID = t2.RESELLER_VERSION_ID
		and t6.LANGUAGE_CODE = t3.LANGUAGE_CODE
	left outer join GENERIC_ENUMERATION_REF t7 on t7.enumeration_key = lower(''DISCOUNT_TYPE'')
		and t7.value = t2.DISCOUNT_TYPE
	left outer join GENERIC_ENUMERATION_VALUES t8 on t8.enumeration_key = t7.enumeration_key
		and t8.value = t7.value
		and t8.LANGUAGE_CODE = t3.LANGUAGE_CODE
	left outer join RATE_CURRENCY_KEY t9 on t2.CURRENCY_CODE = t9.CURRENCY_CODE
	left outer join RATE_CURRENCY_REF t10 on t9.CURRENCY_CODE = t10.CURRENCY_CODE
		and t10.SERVICE_VERSION_ID = {1}
	left outer join RATE_CURRENCY_VALUES t11 on t9.CURRENCY_CODE = t11.CURRENCY_CODE
		and t11.SERVICE_VERSION_ID = {1}
		and t11.LANGUAGE_CODE = t3.LANGUAGE_CODE
	left outer join ACCUMULATOR_KEY t12 on t2.ADDON_ACC_ID1 = t12.ACCUMULATOR_ID
	left outer join ACCUMULATOR_REF t13 on t12.ACCUMULATOR_ID = t13.ACCUMULATOR_ID
		and t13.RESELLER_VERSION_ID = t2.RESELLER_VERSION_ID
	left outer join ACCUMULATOR_VALUES t14 on t12.ACCUMULATOR_ID = t14.ACCUMULATOR_ID
		and t14.RESELLER_VERSION_ID = t2.RESELLER_VERSION_ID
		and t14.LANGUAGE_CODE = t3.LANGUAGE_CODE
	left outer join ACCUMULATOR_KEY t15 on t2.ADDON_ACC_ID2 = t15.ACCUMULATOR_ID
	left outer join ACCUMULATOR_REF t16 on t15.ACCUMULATOR_ID = t16.ACCUMULATOR_ID
		and t16.RESELLER_VERSION_ID = t2.RESELLER_VERSION_ID
	left outer join ACCUMULATOR_VALUES t17 on t15.ACCUMULATOR_ID = t17.ACCUMULATOR_ID
		and t17.RESELLER_VERSION_ID = t2.RESELLER_VERSION_ID
		and t17.LANGUAGE_CODE = t3.LANGUAGE_CODE
	left outer join ACCUMULATOR_KEY t18 on t2.ADDON_ACC_ID3 = t18.ACCUMULATOR_ID
	left outer join ACCUMULATOR_REF t19 on t18.ACCUMULATOR_ID = t19.ACCUMULATOR_ID
		and t19.RESELLER_VERSION_ID = t2.RESELLER_VERSION_ID
	left outer join ACCUMULATOR_VALUES t20 on t18.ACCUMULATOR_ID = t20.ACCUMULATOR_ID
		and t20.RESELLER_VERSION_ID = t2.RESELLER_VERSION_ID
		and t20.LANGUAGE_CODE = t3.LANGUAGE_CODE
	left outer join ACCUMULATOR_KEY t21 on t2.ADDON_ACC_ID4 = t21.ACCUMULATOR_ID
	left outer join ACCUMULATOR_REF t22 on t21.ACCUMULATOR_ID = t22.ACCUMULATOR_ID
		and t22.RESELLER_VERSION_ID = t2.RESELLER_VERSION_ID
	left outer join ACCUMULATOR_VALUES t23 on t21.ACCUMULATOR_ID = t23.ACCUMULATOR_ID
		and t23.RESELLER_VERSION_ID = t2.RESELLER_VERSION_ID
		and t23.LANGUAGE_CODE = t3.LANGUAGE_CODE
where
	t2.RESELLER_VERSION_ID = {0}
	and t3.LANGUAGE_CODE = {2}
