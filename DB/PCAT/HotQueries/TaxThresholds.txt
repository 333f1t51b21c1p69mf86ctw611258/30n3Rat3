select
	t1.TAX_THRESHS_ID as taxThreshsId,
	t1.RESELLER_VERSION_ID as resellerVersionId,
	t4.DISPLAY_VALUE as taxThresholdKey,
	t1.TAX_THRESHOLD_ID as taxThresholdId,
	t7.DISPLAY_VALUE as taxPkgInstIdKey,
	t1.TAX_PKG_INST_ID as taxPkgInstId,
	t1.TAX_TYPE_CODE as taxTypeCode,
	t1.ACCOUNT_CATEGORY as accountCategory,
	t9.DISPLAY_VALUE as chargeEltType,
	t1.CHARGE_ELT_ID as chargeEltId,
	t1.COUNTRY_CODE as countryCode,
	t1.FRANCHISE_CODE as franchiseCode,
	t1.STATE_CODE as stateCode,
	t1.COUNTY_CODE as countyCode,
	t1.CITY_CODE as cityCode, 
        t23.DISPLAY_VALUE as currency,
        t3.TAX_THRESHOLD as taxThreshold,
       (case t1.TAX_TYPE_CODE
          when 0 then {3}
          else t12.DISPLAY_VALUE
        end) taxTypeCodeValues,
       (case t1.COUNTRY_CODE
          when 0 then {3}
          else t14.DISPLAY_VALUE
        end) countryCodeRef,
       (case t1.ACCOUNT_CATEGORY
          when 0 then {3}
          else t17.DISPLAY_VALUE
        end) accountCategoryValues, 
       (case t1.FRANCHISE_CODE
          when 0 then {3}
          else t20.DISPLAY_VALUE
        end) franchiseCodeValues 
from
	TAX_THRESHOLDS t1
	inner join TAX_THRESHOLD_KEY t2 on t1.TAX_THRESHOLD_ID = t2.TAX_THRESHOLD_ID
	inner join TAX_THRESHOLD_REF t3 on t2.TAX_THRESHOLD_ID = t3.TAX_THRESHOLD_ID
		and t3.RESELLER_VERSION_ID = t1.RESELLER_VERSION_ID
	inner join TAX_THRESHOLD_VALUES t4 on t2.TAX_THRESHOLD_ID = t4.TAX_THRESHOLD_ID
		and t4.RESELLER_VERSION_ID = t1.RESELLER_VERSION_ID
		and t4.LANGUAGE_CODE = {2}
	inner join TAX_PKG_INST_ID_KEY t5 on t1.TAX_PKG_INST_ID = t5.TAX_PKG_INST_ID
	inner join TAX_PKG_INST_ID_REF t6 on t5.TAX_PKG_INST_ID = t6.TAX_PKG_INST_ID
		and t6.RESELLER_VERSION_ID = t1.RESELLER_VERSION_ID
	inner join TAX_PKG_INST_ID_VALUES t7 on t5.TAX_PKG_INST_ID = t7.TAX_PKG_INST_ID
		and t7.RESELLER_VERSION_ID = t1.RESELLER_VERSION_ID
		and t7.LANGUAGE_CODE = t4.LANGUAGE_CODE
        left outer join RATE_CURRENCY_KEY t21 on t3.CURRENCY_CODE = t21.CURRENCY_CODE
	left outer join RATE_CURRENCY_REF t22 on t21.CURRENCY_CODE = t22.CURRENCY_CODE
		and t22.SERVICE_VERSION_ID = {1}
	left outer join RATE_CURRENCY_VALUES t23 on t23.CURRENCY_CODE = t22.CURRENCY_CODE
		and t23.SERVICE_VERSION_ID = {1}
		and t23.LANGUAGE_CODE = t4.LANGUAGE_CODE
	left outer join GENERIC_ENUMERATION_REF t8 on t8.enumeration_key = lower(''CHARGE_ELT_TYPE'')
		and t8.value = t1.CHARGE_ELT_TYPE
	left outer join GENERIC_ENUMERATION_VALUES t9 on t9.enumeration_key = t8.enumeration_key
		and t9.value = t8.value
		and t9.LANGUAGE_CODE = t4.LANGUAGE_CODE
        left outer join TAX_TYPE_CODE_KEY t10 on t1.tax_type_code = t10.tax_type_code
        left outer join TAX_TYPE_CODE_REF t11 on t10.tax_type_code = t11.tax_type_code
                and t11.reseller_version_id = t1.RESELLER_VERSION_ID
        left outer join TAX_TYPE_CODE_VALUES t12 on t11.tax_type_code = t12.tax_type_code 
                and t12.reseller_version_id = t1.reseller_version_id 
                and t12.language_code = t4.language_code 
        inner join country_code_ref t13 on t1.country_code = t13.country_code 
        inner join country_code_values t14 on t1.country_code = t14.country_code 
                and t14.language_code = t4.language_code
        left outer join account_category_key t15 on t1.account_category = t15.account_category 
        left outer join account_category_ref t16 on t15.account_category = t16.account_category 
                and t16.service_version_id = {1}
        left outer join account_category_values t17 on t16.account_category = t17.account_category 
                and t17.service_version_id = t16.service_version_id 
                and t17.language_code = t4.language_code 
        left outer join franchise_code_key t18 on t1.franchise_code = t18.franchise_code 
        left outer join franchise_code_ref t19 on t18.franchise_code = t19.franchise_code 
                and t19.reseller_version_id = t1.reseller_version_id 
        left outer join franchise_code_values t20 on t19.franchise_code = t20.franchise_code 
                and t20.reseller_version_id = t19.reseller_version_id 
                and t20.language_code = t4.language_code 
where
	t1.RESELLER_VERSION_ID = {0}
