select
	t4.DISPLAY_VALUE as offerKey,
	t1.OFFER_ID as offerId,
	t6.SERVICE_VERSION_ID as serviceVersionId,
	t7.DISPLAY_VALUE as externalIdTypeKey,
	t1.EXTERNAL_ID_TYPE as externalIdType,
	t1.RESELLER_VERSION_ID as resellerVersionId,
	t1.IS_AUT_GENERATED as isAutGenerated,
	t1.IS_REQUIRED as isRequired,
	t1.MUST_BE_SOLD as mustBeSold,
	t9.DISPLAY_VALUE as invsLineRef,
	t1.INVENTORY_LINE_ID as inventoryLineId,
	t1.AUTO_GENERATE as autoGenerate,
        CASE 
            WHEN t1.IS_AUT_GENERATED = 1 or t1.AUTO_GENERATE = 1 THEN 1
            ELSE 0
        END as isGenerated
from
	OFFER_EXT_ID_COREQ t1
	inner join OFFER_KEY t2 on t1.OFFER_ID = t2.OFFER_ID
	inner join OFFER_REF t3 on t2.OFFER_ID = t3.OFFER_ID
		and t3.RESELLER_VERSION_ID = t1.RESELLER_VERSION_ID
	inner join OFFER_VALUES t4 on t2.OFFER_ID = t4.OFFER_ID
		and t4.RESELLER_VERSION_ID = t1.RESELLER_VERSION_ID
		and t4.LANGUAGE_CODE = {2}
	inner join EXTERNAL_ID_TYPE_KEY t5 on t1.EXTERNAL_ID_TYPE = t5.EXTERNAL_ID_TYPE
	inner join EXTERNAL_ID_TYPE_REF t6 on t5.EXTERNAL_ID_TYPE = t6.EXTERNAL_ID_TYPE
		and t6.SERVICE_VERSION_ID = {1}
	inner join EXTERNAL_ID_TYPE_VALUES t7 on t5.EXTERNAL_ID_TYPE = t7.EXTERNAL_ID_TYPE
		and t7.SERVICE_VERSION_ID = t6.SERVICE_VERSION_ID
		and t7.LANGUAGE_CODE = t4.LANGUAGE_CODE
	left outer join INVS_LINE_REF t8 on t1.INVENTORY_LINE_ID = t8.INVENTORY_LINE_ID
	left outer join INVS_LINE_VALUES t9 on t8.INVENTORY_LINE_ID = t9.INVENTORY_LINE_ID
		and t9.LANGUAGE_CODE = t4.LANGUAGE_CODE
where
	t1.RESELLER_VERSION_ID = {0}
